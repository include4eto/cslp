library('igraph')

# adj matrix for the big cluster
adj = matrix(c(0, 10, 5,-1,-1,30,-1,-1,-1,-1,-1,-1,-1,-1,-1,
10, 0,-1, 3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
-1, 4, 0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
-1, 3,-1, 0, 2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
-1, 4,-1,-1, 0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
30,-1,-1,-1,-1, 0, 5,-1,-1,-1,45,-1,-1,-1,-1,
-1,-1,-1,-1,-1, 7, 0, 2,-1,-1,-1,-1,-1,-1,-1,
-1,-1,-1,-1,-1,-1, 2, 0,-1, 3,-1,-1,-1,-1,-1,
-1,-1,-1,-1,-1,-1, 3,-1, 0,-1,-1,-1,-1,-1,-1,
-1,-1,-1,-1,-1,-1,-1,-1, 3, 0,-1,-1,-1,-1,-1,
-1,-1,-1,-1,-1,45,-1,-1,-1,-1, 0, 2,-1,-1, 5,
-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 2, 0, 3,-1,-1,
-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 7,-1, 0, 8,-1,
-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,-1,-1, 0,-1,
-1,-1,-1,-1,-1,-1,-1,-1,-1,-1, 5,-1,-1,-1, 0), nrow=15, ncol=15)

g1 = graph.adjacency(adj)
E(g1)$weight = 1
# use the original weights
g2 = simplify(g1, edge.attr.comb=list(weight="sum"))

# start labels at 0
png(filename='three_neighborhoods.png')
plot(g2, vertex.label=V(g2)-1, edge.label=round(E(g2)$weight, 3))
dev.off()

# three neighborhoods
adj2 = matrix(c(
0,3,-1,-1,-1,-1,-1,-1,-1,5,
3,0,5,-1,-1,-1,-1,-1,-1,-1,
-1,-1,0,7,-1,-1,-1,-1,-1,-1,
13,8,7,0,3,-1,6,-1,-1,15,
-1,-1,-1,-1,0,3,-1,-1,-1,-1,
-1,-1,-1,10,-1,0,1,5,-1,-1,
-1,-1,-1,-1,-1,-1,0,8,-1,-1,
-1,-1,-1,-1,-1,-1,6,0,12,-1,
9,-1,-1,-1,-1,-1,-1,-1,0,10,
5,1,-1,-1,-1,-1,-1,-1,-1,0), nrow=15, ncol=15)

dev.new()
g1_1 = graph.adjacency(adj2)
E(g1_1)$weight = 1
# use the original weights
g2_1 = simplify(g1_1, edge.attr.comb=list(weight="sum"))

# start labels at 0
png(filename='big_cluster.png')
plot(g2_1, vertex.label=V(g2_1)-1, edge.label=round(E(g2_1)$weight, 3))
dev.off()

